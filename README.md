# PowerPointç¼–è¾‘MCP Server

è¿™æ˜¯ä¸€ä¸ªåŸºäºMCP (Model Context Protocol) çš„PowerPointç¼–è¾‘æœåŠ¡å™¨ï¼Œæä¾›äº†åˆ›å»ºå’Œç¼–è¾‘PowerPointæ¼”ç¤ºæ–‡ç¨¿çš„å®Œæ•´åŠŸèƒ½ï¼ŒåŒ…æ‹¬å†…å®¹ç¼–è¾‘ã€æ ¼å¼åŒ–å’Œä¸“ä¸šåŠ¨ç”»æ•ˆæœã€‚

## âœ¨ æœ€æ–°æ›´æ–°

- ğŸ¬ **å…¨æ–°åŠ¨ç”»ç³»ç»Ÿ** - æ·»åŠ äº†å¤šç§ä¸“ä¸šè¿‡æ¸¡åŠ¨ç”»æ•ˆæœ
- ğŸš€ **ä¸€é”®ä¸“ä¸šåŒ–** - å¿«é€Ÿè®©æ¼”ç¤ºæ–‡ç¨¿å˜å¾—ä¸“ä¸š
- ğŸ¯ **æ™ºèƒ½æ¨è** - ä¼˜åŒ–å·¥å…·æè¿°ï¼Œæé«˜AIæ¨¡å‹ä½¿ç”¨ç‡
- ğŸ› ï¸ **ä¾¿åˆ©å‡½æ•°** - ç®€åŒ–å¤æ‚æ“ä½œï¼Œæä¾›ç›´è§‚çš„å‚æ•°æ¥å£

## é¡¹ç›®ç»“æ„

- `main.py` - MCPæœåŠ¡å™¨ä¸»ç¨‹åºï¼Œå¤„ç†MCPåè®®é€šä¿¡
- `tool.py` - PowerPointç¼–è¾‘å™¨å·¥å…·ç±»ï¼ŒåŒ…å«æ‰€æœ‰PPTç¼–è¾‘åŠŸèƒ½
- `example.py` - ä½¿ç”¨ç¤ºä¾‹
- `test_transitions.py` - è¿‡æ¸¡åŠ¨ç”»åŠŸèƒ½æµ‹è¯•
- `transition_improvements_guide.md` - åŠ¨ç”»åŠŸèƒ½æ”¹è¿›æŒ‡å—
- `requirements.txt` - é¡¹ç›®ä¾èµ–
- `mcp_config.json` - MCPå®¢æˆ·ç«¯é…ç½®æ–‡ä»¶

## åŠŸèƒ½ç‰¹æ€§

### åŸºç¡€åŠŸèƒ½
- åˆ›å»ºæ–°çš„PowerPointæ¼”ç¤ºæ–‡ç¨¿
- æ‰“å¼€ç°æœ‰çš„PowerPointæ–‡ä»¶
- ä¿å­˜æ¼”ç¤ºæ–‡ç¨¿
- è·å–æ¼”ç¤ºæ–‡ç¨¿ä¿¡æ¯

### å¹»ç¯ç‰‡æ“ä½œ
- æ·»åŠ æ–°å¹»ç¯ç‰‡ï¼ˆæ”¯æŒä¸åŒå¸ƒå±€ï¼‰
- åˆ é™¤å¹»ç¯ç‰‡
- å¤åˆ¶å¹»ç¯ç‰‡
- ç§»åŠ¨å¹»ç¯ç‰‡ä½ç½®
- è®¾ç½®å¹»ç¯ç‰‡èƒŒæ™¯é¢œè‰²

### å†…å®¹ç¼–è¾‘
- æ·»åŠ æ–‡æœ¬æ¡†å’Œæ–‡æœ¬å†…å®¹
- æ·»åŠ æ ‡é¢˜å¹»ç¯ç‰‡
- æ·»åŠ å¸¦é¡¹ç›®ç¬¦å·çš„å†…å®¹
- æ’å…¥å›¾ç‰‡
- æ·»åŠ å„ç§å½¢çŠ¶ï¼ˆçŸ©å½¢ã€æ¤­åœ†ã€ä¸‰è§’å½¢ç­‰ï¼‰
- æ·»åŠ è¡¨æ ¼
- è®¾ç½®è¡¨æ ¼å•å…ƒæ ¼æ–‡æœ¬

### æ ¼å¼åŒ–åŠŸèƒ½
- è®¾ç½®æ–‡æœ¬æ ¼å¼ï¼ˆå­—ä½“ã€å¤§å°ã€é¢œè‰²ã€ç²—ä½“ã€æ–œä½“ã€ä¸‹åˆ’çº¿ï¼‰
- ä¸ºå½¢çŠ¶æ·»åŠ è¶…é“¾æ¥
- è·å–å¹»ç¯ç‰‡ä¸­æ‰€æœ‰å½¢çŠ¶çš„è¯¦ç»†ä¿¡æ¯

### ğŸ¬ ä¸“ä¸šåŠ¨ç”»å’Œè¿‡æ¸¡æ•ˆæœ
- **ä¸€é”®ä¸“ä¸šåŒ–** - å¿«é€Ÿä¸ºæ•´ä¸ªæ¼”ç¤ºæ–‡ç¨¿æ·»åŠ ä¸“ä¸šè¿‡æ¸¡æ•ˆæœ
- **å¤šç§åŠ¨ç”»é£æ ¼** - æ·¡å…¥æ·¡å‡ºã€æ¨å…¥ã€æ“¦é™¤ã€åˆ†å‰²ã€ç¼©æ”¾ã€ç™¾å¶çª—ã€æº¶è§£ç­‰8ç§æ•ˆæœ
- **æ™ºèƒ½é€Ÿåº¦æ§åˆ¶** - å¿«é€Ÿã€ä¸­ç­‰ã€æ…¢é€Ÿä¸‰æ¡£é€Ÿåº¦é€‰æ‹©
- **è‡ªåŠ¨æ’­æ”¾æ”¯æŒ** - æ”¯æŒè‡ªåŠ¨å‰è¿›å’Œç‚¹å‡»å‰è¿›
- **æ‰¹é‡åº”ç”¨** - ä¸€æ¬¡æ€§ä¸ºæ‰€æœ‰å¹»ç¯ç‰‡è®¾ç½®ç»Ÿä¸€åŠ¨ç”»
- **ä¾¿åˆ©å‡½æ•°** - æä¾›æµç•…è¿‡æ¸¡ã€åŠ¨æ„Ÿæ•ˆæœç­‰é¢„è®¾é€‰é¡¹

## å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

## ä½¿ç”¨æ–¹æ³•

### ä½œä¸ºMCP Serverè¿è¡Œ

```bash
python main.py
```

### ç›´æ¥ä½¿ç”¨PowerPointEditorç±»

```python
from tool import PowerPointEditor

# åˆ›å»ºç¼–è¾‘å™¨å®ä¾‹
editor = PowerPointEditor()

# åˆ›å»ºæ–°æ¼”ç¤ºæ–‡ç¨¿
editor.create_presentation()

# æ·»åŠ æ ‡é¢˜å¹»ç¯ç‰‡
editor.add_title_slide("æˆ‘çš„æ¼”ç¤ºæ–‡ç¨¿", "å‰¯æ ‡é¢˜")

# ä¿å­˜æ–‡ä»¶
editor.save_presentation("my_presentation.pptx")
```

### è¿è¡Œç¤ºä¾‹

```bash
python example.py
```

### æµ‹è¯•åŠ¨ç”»åŠŸèƒ½

```bash
python test_transitions.py
```

## ğŸ¬ åŠ¨ç”»åŠŸèƒ½å¿«é€Ÿå¼€å§‹

```python
from tool import PowerPointEditor

editor = PowerPointEditor()
editor.create_presentation()

# æ·»åŠ å‡ å¼ å¹»ç¯ç‰‡
editor.add_title_slide("æ¬¢è¿", "æˆ‘çš„æ¼”ç¤ºæ–‡ç¨¿")
editor.add_title_slide("å†…å®¹", "ä¸»è¦å†…å®¹")
editor.add_title_slide("ç»“æŸ", "è°¢è°¢è§‚çœ‹")

# ä¸€é”®ä¸“ä¸šåŒ– - ä¸ºæ‰€æœ‰å¹»ç¯ç‰‡æ·»åŠ æ·¡å…¥æ·¡å‡ºæ•ˆæœ
editor.make_presentation_professional()

# æˆ–è€…æ·»åŠ åŠ¨æ„Ÿæ•ˆæœ
# editor.add_dynamic_effects()

# ä¿å­˜æ–‡ä»¶
editor.save_presentation("professional_presentation.pptx")
```

## ğŸ› ï¸ å¯ç”¨å·¥å…·

### ğŸ¬ åŠ¨ç”»å’Œè¿‡æ¸¡å·¥å…·ï¼ˆæ–°å¢ï¼‰

#### add_slide_animation
ä¸ºå•å¼ å¹»ç¯ç‰‡æ·»åŠ åŠ¨ç”»è¿‡æ¸¡æ•ˆæœï¼Œè®©æ¼”ç¤ºæ›´ç”ŸåŠ¨æœ‰è¶£
- `slide_index`: å¹»ç¯ç‰‡ç´¢å¼•
- `animation_style`: åŠ¨ç”»é£æ ¼ï¼ˆfade, push, wipe, zoom, split, blinds, dissolve, noneï¼‰
- `speed`: åŠ¨ç”»é€Ÿåº¦ï¼ˆfast, medium, slowï¼‰
- `auto_advance`: æ˜¯å¦è‡ªåŠ¨åˆ‡æ¢åˆ°ä¸‹ä¸€å¼ 
- `auto_advance_seconds`: è‡ªåŠ¨åˆ‡æ¢å»¶è¿Ÿæ—¶é—´

#### make_presentation_dynamic
ä¸ºæ•´ä¸ªæ¼”ç¤ºæ–‡ç¨¿æ·»åŠ ç»Ÿä¸€çš„åŠ¨ç”»æ•ˆæœï¼Œåˆ¶ä½œä¸“ä¸šæ¼”ç¤ºæ–‡ç¨¿çš„é‡è¦æ­¥éª¤
- `animation_style`: ç»Ÿä¸€çš„åŠ¨ç”»é£æ ¼ï¼ˆé»˜è®¤fadeï¼‰
- `speed`: åŠ¨ç”»é€Ÿåº¦ï¼ˆé»˜è®¤mediumï¼‰

#### make_professional_presentation â­
ä¸€é”®è®©æ¼”ç¤ºæ–‡ç¨¿å˜å¾—ä¸“ä¸šï¼è‡ªåŠ¨ä¸ºæ‰€æœ‰å¹»ç¯ç‰‡æ·»åŠ ä¼˜é›…çš„æ·¡å…¥æ·¡å‡ºè¿‡æ¸¡æ•ˆæœ
- æ— å‚æ•°ï¼Œä¸€é”®æ“ä½œ

#### add_smooth_transitions
ä¸ºæ¼”ç¤ºæ–‡ç¨¿æ·»åŠ æµç•…çš„è¿‡æ¸¡åŠ¨ç”»ï¼Œè®©å¹»ç¯ç‰‡åˆ‡æ¢æ›´åŠ è‡ªç„¶
- æ— å‚æ•°ï¼Œé¢„è®¾æµç•…æ•ˆæœ

#### add_dynamic_effects
ä¸ºæ¼”ç¤ºæ–‡ç¨¿æ·»åŠ åŠ¨æ„Ÿçš„è¿‡æ¸¡æ•ˆæœï¼Œè®©æ¼”ç¤ºæ›´æœ‰æ´»åŠ›
- æ— å‚æ•°ï¼Œé¢„è®¾åŠ¨æ„Ÿæ•ˆæœ

#### get_animation_options
æŸ¥çœ‹æ‰€æœ‰å¯ç”¨çš„å¹»ç¯ç‰‡åŠ¨ç”»æ•ˆæœé€‰é¡¹
- æ— å‚æ•°

### ğŸ“„ åŸºç¡€å·¥å…·

#### 1. create_presentation
åˆ›å»ºæ–°çš„PowerPointæ¼”ç¤ºæ–‡ç¨¿

#### 2. open_presentation
æ‰“å¼€ç°æœ‰çš„PowerPointæ–‡ä»¶
- `file_path`: æ–‡ä»¶è·¯å¾„

#### 3. save_presentation
ä¿å­˜æ¼”ç¤ºæ–‡ç¨¿
- `file_path`: ä¿å­˜è·¯å¾„ï¼ˆå¯é€‰ï¼‰

### ğŸ“ å†…å®¹ç¼–è¾‘å·¥å…·

#### 4. add_slide
æ·»åŠ æ–°å¹»ç¯ç‰‡
- `layout_index`: å¸ƒå±€ç´¢å¼•ï¼ˆ0=æ ‡é¢˜å¹»ç¯ç‰‡ï¼Œ1=æ ‡é¢˜å’Œå†…å®¹ï¼‰

#### 5. add_text_box
æ·»åŠ æ–‡æœ¬æ¡†
- `slide_index`: å¹»ç¯ç‰‡ç´¢å¼•
- `text`: æ–‡æœ¬å†…å®¹
- `left`, `top`, `width`, `height`: ä½ç½®å’Œå¤§å°ï¼ˆè‹±å¯¸ï¼‰
- `font_size`: å­—ä½“å¤§å°
- `font_color`: å­—ä½“é¢œè‰²ï¼ˆåå…­è¿›åˆ¶ï¼‰

#### 6. add_title_slide
æ·»åŠ æ ‡é¢˜å¹»ç¯ç‰‡
- `title`: æ ‡é¢˜
- `subtitle`: å‰¯æ ‡é¢˜ï¼ˆå¯é€‰ï¼‰

#### 7. add_bullet_points
æ·»åŠ é¡¹ç›®ç¬¦å·å†…å®¹
- `slide_index`: å¹»ç¯ç‰‡ç´¢å¼•
- `title`: æ ‡é¢˜
- `bullet_points`: é¡¹ç›®ç¬¦å·åˆ—è¡¨

#### 8. add_image
æ·»åŠ å›¾ç‰‡
- `slide_index`: å¹»ç¯ç‰‡ç´¢å¼•
- `image_path`: å›¾ç‰‡è·¯å¾„
- `left`, `top`: ä½ç½®ï¼ˆè‹±å¯¸ï¼‰
- `width`, `height`: å¤§å°ï¼ˆè‹±å¯¸ï¼Œå¯é€‰ï¼‰

#### 9. add_shape
æ·»åŠ å½¢çŠ¶
- `slide_index`: å¹»ç¯ç‰‡ç´¢å¼•
- `shape_type`: å½¢çŠ¶ç±»å‹ï¼ˆrectangle, oval, triangle, diamond, pentagon, hexagon, star, arrowï¼‰
- `left`, `top`, `width`, `height`: ä½ç½®å’Œå¤§å°ï¼ˆè‹±å¯¸ï¼‰
- `fill_color`: å¡«å……é¢œè‰²ï¼ˆåå…­è¿›åˆ¶ï¼‰

#### 10. add_table
æ·»åŠ è¡¨æ ¼
- `slide_index`: å¹»ç¯ç‰‡ç´¢å¼•
- `rows`: è¡¨æ ¼è¡Œæ•°
- `cols`: è¡¨æ ¼åˆ—æ•°
- `left`, `top`, `width`, `height`: ä½ç½®å’Œå¤§å°ï¼ˆè‹±å¯¸ï¼‰

#### 11. set_table_cell_text
è®¾ç½®è¡¨æ ¼å•å…ƒæ ¼æ–‡æœ¬
- `slide_index`: å¹»ç¯ç‰‡ç´¢å¼•
- `table_index`: è¡¨æ ¼ç´¢å¼•
- `row`: è¡Œç´¢å¼•
- `col`: åˆ—ç´¢å¼•
- `text`: æ–‡æœ¬å†…å®¹

### ğŸ¨ æ ¼å¼åŒ–å’Œæ ·å¼å·¥å…·

#### 12. set_slide_background_color
è®¾ç½®å¹»ç¯ç‰‡èƒŒæ™¯é¢œè‰²
- `slide_index`: å¹»ç¯ç‰‡ç´¢å¼•
- `color`: èƒŒæ™¯é¢œè‰²ï¼ˆåå…­è¿›åˆ¶ï¼‰

#### 13. add_hyperlink
ä¸ºå½¢çŠ¶æ·»åŠ è¶…é“¾æ¥
- `slide_index`: å¹»ç¯ç‰‡ç´¢å¼•
- `shape_index`: å½¢çŠ¶ç´¢å¼•
- `url`: è¶…é“¾æ¥URL
- `display_text`: æ˜¾ç¤ºæ–‡æœ¬ï¼ˆå¯é€‰ï¼‰

#### 14. set_text_formatting
è®¾ç½®æ–‡æœ¬æ ¼å¼
- `slide_index`: å¹»ç¯ç‰‡ç´¢å¼•
- `shape_index`: å½¢çŠ¶ç´¢å¼•
- `font_name`: å­—ä½“åç§°ï¼ˆå¯é€‰ï¼‰
- `font_size`: å­—ä½“å¤§å°ï¼ˆå¯é€‰ï¼‰
- `font_color`: å­—ä½“é¢œè‰²ï¼ˆå¯é€‰ï¼‰
- `bold`: æ˜¯å¦åŠ ç²—ï¼ˆå¯é€‰ï¼‰
- `italic`: æ˜¯å¦æ–œä½“ï¼ˆå¯é€‰ï¼‰
- `underline`: æ˜¯å¦ä¸‹åˆ’çº¿ï¼ˆå¯é€‰ï¼‰

### ğŸ”§ ç®¡ç†å·¥å…·

#### 15. get_presentation_info
è·å–æ¼”ç¤ºæ–‡ç¨¿ä¿¡æ¯

#### 16. delete_slide
åˆ é™¤å¹»ç¯ç‰‡
- `slide_index`: è¦åˆ é™¤çš„å¹»ç¯ç‰‡ç´¢å¼•

#### 17. duplicate_slide
å¤åˆ¶å¹»ç¯ç‰‡
- `slide_index`: è¦å¤åˆ¶çš„å¹»ç¯ç‰‡ç´¢å¼•

#### 18. move_slide
ç§»åŠ¨å¹»ç¯ç‰‡ä½ç½®
- `from_index`: æºä½ç½®ç´¢å¼•
- `to_index`: ç›®æ ‡ä½ç½®ç´¢å¼•

#### 19. get_slide_shapes_info
è·å–å¹»ç¯ç‰‡ä¸­æ‰€æœ‰å½¢çŠ¶çš„ä¿¡æ¯
- `slide_index`: å¹»ç¯ç‰‡ç´¢å¼•

### ğŸ¬ ä¼ ç»ŸåŠ¨ç”»å·¥å…·ï¼ˆå‘åå…¼å®¹ï¼‰

#### 20. set_slide_transition
è®¾ç½®å¹»ç¯ç‰‡è¿‡æ¸¡æ•ˆæœï¼ˆæ¨èä½¿ç”¨æ–°çš„åŠ¨ç”»å·¥å…·ï¼‰
- `slide_index`: å¹»ç¯ç‰‡ç´¢å¼•
- `transition_type`: è¿‡æ¸¡ç±»å‹ï¼ˆnone, fade, push, wipe, split, zoom, blinds, dissolveï¼‰
- `duration`: è¿‡æ¸¡æŒç»­æ—¶é—´ï¼ˆç§’ï¼‰
- `advance_on_click`: æ˜¯å¦ç‚¹å‡»å‰è¿›
- `advance_after_time`: è‡ªåŠ¨å‰è¿›æ—¶é—´ï¼ˆç§’ï¼Œå¯é€‰ï¼‰

#### 21. get_available_transitions
è·å–å¯ç”¨çš„è¿‡æ¸¡æ•ˆæœåˆ—è¡¨
- æ— å‚æ•°

## ğŸ’¡ ä½¿ç”¨æŠ€å·§

### è®©AIæ›´å¥½åœ°ä½¿ç”¨åŠ¨ç”»åŠŸèƒ½

ä¸ºäº†è®©AIæ¨¡å‹æ›´ä¸»åŠ¨åœ°ä½¿ç”¨åŠ¨ç”»åŠŸèƒ½ï¼Œå¯ä»¥åœ¨å¯¹è¯ä¸­ä½¿ç”¨è¿™äº›å…³é”®è¯ï¼š

- **"è®©æ¼”ç¤ºæ›´ä¸“ä¸š"** â†’ AIä¼šè°ƒç”¨ `make_professional_presentation`
- **"æ·»åŠ åŠ¨ç”»æ•ˆæœ"** â†’ AIä¼šä½¿ç”¨ `add_slide_animation` æˆ– `make_presentation_dynamic`
- **"è®©å¹»ç¯ç‰‡åˆ‡æ¢æ›´æµç•…"** â†’ AIä¼šè°ƒç”¨ `add_smooth_transitions`
- **"è®©æ¼”ç¤ºæ›´æœ‰æ´»åŠ›"** â†’ AIä¼šä½¿ç”¨ `add_dynamic_effects`

### æ¨èçš„å·¥ä½œæµç¨‹

1. **åˆ›å»ºå†…å®¹** - å…ˆæ·»åŠ æ‰€æœ‰å¹»ç¯ç‰‡å’Œå†…å®¹
2. **ä¸€é”®ä¸“ä¸šåŒ–** - ä½¿ç”¨ `make_professional_presentation()` å¿«é€Ÿæ·»åŠ è¿‡æ¸¡æ•ˆæœ
3. **ä¸ªæ€§åŒ–è°ƒæ•´** - æ ¹æ®éœ€è¦ä¸ºç‰¹å®šå¹»ç¯ç‰‡è®¾ç½®ä¸åŒçš„åŠ¨ç”»æ•ˆæœ
4. **é¢„è§ˆå’Œä¿å­˜** - ä¿å­˜æ–‡ä»¶å¹¶åœ¨PowerPointä¸­é¢„è§ˆæ•ˆæœ

## âš ï¸ æ³¨æ„äº‹é¡¹

1. ç¡®ä¿å®‰è£…äº†æ‰€æœ‰å¿…éœ€çš„ä¾èµ–åŒ…ï¼ˆç‰¹åˆ«æ˜¯ `lxml` ç”¨äºåŠ¨ç”»åŠŸèƒ½ï¼‰
2. å›¾ç‰‡æ–‡ä»¶è·¯å¾„å¿…é¡»å­˜åœ¨ä¸”å¯è®¿é—®
3. å¹»ç¯ç‰‡ç´¢å¼•ä»0å¼€å§‹
4. é¢œè‰²ä½¿ç”¨åå…­è¿›åˆ¶æ ¼å¼ï¼ˆå¦‚ï¼š000000è¡¨ç¤ºé»‘è‰²ï¼ŒFF0000è¡¨ç¤ºçº¢è‰²ï¼‰
5. ä½ç½®å’Œå¤§å°å•ä½ä¸ºè‹±å¯¸
6. åŠ¨ç”»æ•ˆæœéœ€è¦åœ¨PowerPointä¸­æ‰“å¼€æ–‡ä»¶æ‰èƒ½çœ‹åˆ°å®Œæ•´æ•ˆæœ

## é”™è¯¯å¤„ç†

æ‰€æœ‰æ“ä½œéƒ½åŒ…å«é”™è¯¯å¤„ç†ï¼Œè¿”å›æ ¼å¼ä¸ºï¼š
```json
{
  "success": true/false,
  "message": "æ“ä½œç»“æœæ¶ˆæ¯",
  "error": "é”™è¯¯ä¿¡æ¯ï¼ˆå¦‚æœæœ‰ï¼‰"
}
```

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ï¼

## ğŸ“„ è®¸å¯è¯

MIT License
